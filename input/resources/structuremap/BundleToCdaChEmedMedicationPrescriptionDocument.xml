<StructureMap xmlns="http://hl7.org/fhir">
   <id value="BundleToCdaChEmedMedicationPrescriptionDocument"></id>
   <url value="http://fhir.ch/ig/cda-fhir-maps/StructureMap/BundleToCdaChEmedMedicationPrescriptionDocument"></url>
   <name value="FhirBundleToCdaChEmedMedicationPrescriptionDocument"></name>
   <structure>
      <url value="http://hl7.org/fhir/cda/StructureDefinition/ClinicalDocument"></url>
      <mode value="target"></mode>
      <alias value="ClinicalDocument"></alias>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/cda/StructureDefinition/AssignedAuthor"></url>
      <mode value="target"></mode>
      <alias value="AssignedAuthor"></alias>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/cda/StructureDefinition/AssignedEntity"></url>
      <mode value="target"></mode>
      <alias value="AssignedEntity"></alias>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/cda/StructureDefinition/Author"></url>
      <mode value="target"></mode>
      <alias value="Author"></alias>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/cda/StructureDefinition/CustodianOrganization"></url>
      <mode value="target"></mode>
      <alias value="CustodianOrganization"></alias>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/cda/StructureDefinition/IVL_TS"></url>
      <mode value="target"></mode>
      <alias value="IVL_TS"></alias>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/cda/StructureDefinition/EIVL_TS"></url>
      <mode value="target"></mode>
      <alias value="EIVL_TS"></alias>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/cda/StructureDefinition/PatientRole"></url>
      <mode value="target"></mode>
      <alias value="PatientRole"></alias>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/cda/StructureDefinition/RecordTarget"></url>
      <mode value="target"></mode>
      <alias value="RecordTarget"></alias>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/cda/StructureDefinition/Section"></url>
      <mode value="target"></mode>
      <alias value="Section"></alias>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/cda/StructureDefinition/SubstanceAdministration"></url>
      <mode value="target"></mode>
      <alias value="SubstanceAdministration"></alias>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/cda/StructureDefinition/SXPR_TS"></url>
      <mode value="target"></mode>
      <alias value="SXPR_TS"></alias>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/cda/StructureDefinition/Supply"></url>
      <mode value="target"></mode>
      <alias value="Supply"></alias>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/StructureDefinition/Bundle"></url>
      <mode value="source"></mode>
      <alias value="Bundle"></alias>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/StructureDefinition/Composition"></url>
      <mode value="source"></mode>
      <alias value="Composition"></alias>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/StructureDefinition/Patient"></url>
      <mode value="source"></mode>
      <alias value="Patient"></alias>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/StructureDefinition/Practitioner"></url>
      <mode value="source"></mode>
      <alias value="Practitioner"></alias>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/StructureDefinition/Organization"></url>
      <mode value="source"></mode>
      <alias value="Organization"></alias>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/StructureDefinition/MedicationRequest"></url>
      <mode value="source"></mode>
      <alias value="MedicationRequest"></alias>
   </structure>
   <structure>
      <url value="http://hl7.org/fhir/StructureDefinition/Dosage"></url>
      <mode value="source"></mode>
      <alias value="Dosage"></alias>
   </structure>
   <import value="http://fhir.ch/ig/cda-fhir-maps/StructureMap/FhirToCdaTypes"></import>
   <import value="http://fhir.ch/ig/cda-fhir-maps/StructureMap/BundleToCda"></import>
   <import value="http://fhir.ch/ig/cda-fhir-maps/StructureMap/BundleToCdaCh"></import>
   <group>
      <name value="BundleToCdaChEmedMedicationPrescriptionDocument"></name>
      <typeMode value="none"></typeMode>
      <input>
         <name value="bundle"></name>
         <type value="Bundle"></type>
         <mode value="source"></mode>
      </input>
      <input>
         <name value="cda"></name>
         <type value="ClinicalDocument"></type>
         <mode value="target"></mode>
      </input>
      <rule>
         <name value="bundle"></name>
         <source>
            <context value="bundle"></context>
         </source>
         <target>
            <context value="cda"></context>
            <contextType value="variable"></contextType>
            <element value="recordTarget"></element>
            <variable value="recordTarget"></variable>
         </target>
         <target>
            <context value="cda"></context>
            <contextType value="variable"></contextType>
            <element value="author"></element>
            <variable value="author"></variable>
         </target>
         <dependent>
            <name value="BundleToClinicalDocumentEmedMedicationPrescriptionDocument"></name>
            <variable value="bundle"></variable>
            <variable value="recordTarget"></variable>
            <variable value="author"></variable>
            <variable value="cda"></variable>
         </dependent>
      </rule>
   </group>
   <group>
      <name value="CompositionClinicalDocumentChEmedMedicationPrescriptionDocument"></name>
      <typeMode value="none"></typeMode>
      <input>
         <name value="bundle"></name>
         <type value="Bundle"></type>
         <mode value="source"></mode>
      </input>
      <input>
         <name value="composition"></name>
         <type value="Composition"></type>
         <mode value="source"></mode>
      </input>
      <input>
         <name value="cda"></name>
         <type value="ClinicalDocument"></type>
         <mode value="target"></mode>
      </input>
      <rule>
         <name value="SectionPrescriptionSectionContentModule"></name>
         <source>
            <context value="composition"></context>
            <element value="section"></element>
            <variable value="section"></variable>
            <condition value="$this.code.coding.where((system = 'http://loinc.org') and (code = '57828-6'))"></condition>
         </source>
         <target>
            <context value="cda"></context>
            <contextType value="variable"></contextType>
            <element value="component"></element>
            <variable value="component"></variable>
         </target>
         <rule>
            <name value="contextConductionInd"></name>
            <source>
               <context value="section"></context>
            </source>
            <target>
               <context value="component"></context>
               <contextType value="variable"></contextType>
               <element value="contextConductionInd"></element>
               <transform value="copy"></transform>
               <parameter>
                  <valueBoolean value="true"></valueBoolean>
               </parameter>
            </target>
         </rule>
         <rule>
            <name value="cdasection"></name>
            <source>
               <context value="section"></context>
            </source>
            <target>
               <context value="component"></context>
               <contextType value="variable"></contextType>
               <element value="structuredBody"></element>
               <variable value="structuredBody"></variable>
            </target>
            <target>
               <context value="structuredBody"></context>
               <contextType value="variable"></contextType>
               <element value="component"></element>
               <variable value="component"></variable>
            </target>
            <target>
               <context value="component"></context>
               <contextType value="variable"></contextType>
               <element value="section"></element>
               <variable value="cdasection"></variable>
            </target>
            <dependent>
               <name value="SectionPrescriptionSectionContentModule"></name>
               <variable value="bundle"></variable>
               <variable value="section"></variable>
               <variable value="cdasection"></variable>
            </dependent>
         </rule>
      </rule>
   </group>
   <group>
      <name value="SectionPrescriptionSectionContentModule"></name>
      <extends value="SectionCdaSection"></extends>
      <typeMode value="none"></typeMode>
      <input>
         <name value="bundle"></name>
         <type value="Bundle"></type>
         <mode value="source"></mode>
      </input>
      <input>
         <name value="section"></name>
         <type value="Section"></type>
         <mode value="source"></mode>
      </input>
      <input>
         <name value="cdasection"></name>
         <type value="CdaSection"></type>
         <mode value="target"></mode>
      </input>
      <rule>
         <name value="CH-PHARM Prescription Section Content Module"></name>
         <source>
            <context value="section"></context>
         </source>
         <target>
            <context value="cdasection"></context>
            <contextType value="variable"></contextType>
            <element value="templateId"></element>
            <variable value="templateId"></variable>
         </target>
         <target>
            <context value="templateId"></context>
            <contextType value="variable"></contextType>
            <element value="root"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="2.16.756.5.30.1.1.10.3.10"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value=" IHE Prescription Section Content Module"></name>
         <source>
            <context value="section"></context>
         </source>
         <target>
            <context value="cdasection"></context>
            <contextType value="variable"></contextType>
            <element value="templateId"></element>
            <variable value="templateId"></variable>
         </target>
         <target>
            <context value="templateId"></context>
            <contextType value="variable"></contextType>
            <element value="root"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="1.3.6.1.4.1.19376.1.9.1.2.1"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="extension"></name>
         <source>
            <context value="section"></context>
            <variable value="section"></variable>
            <condition value="$this.extension.where(url = 'http://fhir.ch/ig/ch-core/StructureDefinition/ch-ext-epr-sectionid').exists() = false"></condition>
         </source>
         <target>
            <context value="cdasection"></context>
            <contextType value="variable"></contextType>
            <element value="id"></element>
            <variable value="id"></variable>
         </target>
         <rule>
            <name value="upper"></name>
            <source>
               <context value="section"></context>
            </source>
            <target>
               <variable value="uuid"></variable>
               <transform value="uuid"></transform>
            </target>
            <target>
               <context value="id"></context>
               <contextType value="variable"></contextType>
               <element value="root"></element>
               <transform value="evaluate"></transform>
               <parameter>
                  <valueString value="%uuid.upper()"></valueString>
               </parameter>
            </target>
         </rule>
      </rule>
      <rule>
         <name value="entry"></name>
         <source>
            <context value="bundle"></context>
            <element value="entry"></element>
            <variable value="entry"></variable>
         </source>
         <rule>
            <name value="MedicationRequest"></name>
            <source>
               <context value="entry"></context>
               <element value="resource"></element>
               <variable value="medicationRequest"></variable>
               <condition value="('MedicationRequest' + '/' + $this.id) in %section.entry.reference"></condition>
            </source>
            <target>
               <context value="cdasection"></context>
               <contextType value="variable"></contextType>
               <element value="entry"></element>
               <variable value="entry"></variable>
            </target>
            <target>
               <context value="entry"></context>
               <contextType value="variable"></contextType>
               <element value="substanceAdministration"></element>
               <variable value="substanceAdministration"></variable>
            </target>
            <dependent>
               <name value="PrescriptionItemEntryContentModule"></name>
               <variable value="bundle"></variable>
               <variable value="medicationRequest"></variable>
               <variable value="substanceAdministration"></variable>
            </dependent>
         </rule>
      </rule>
   </group>
   <group>
      <name value="AnnotationComment"></name>
      <typeMode value="none"></typeMode>
      <input>
         <name value="note"></name>
         <type value="Annotation"></type>
         <mode value="source"></mode>
      </input>
      <input>
         <name value="act"></name>
         <type value="Act"></type>
         <mode value="target"></mode>
      </input>
      <rule>
         <name value="ACT"></name>
         <source>
            <context value="note"></context>
         </source>
         <target>
            <context value="act"></context>
            <contextType value="variable"></contextType>
            <element value="classCode"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="ACT"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="EVN"></name>
         <source>
            <context value="note"></context>
         </source>
         <target>
            <context value="act"></context>
            <contextType value="variable"></contextType>
            <element value="moodCode"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="EVN"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="TemplateId"></name>
         <source>
            <context value="note"></context>
         </source>
         <target>
            <context value="act"></context>
            <contextType value="variable"></contextType>
            <element value="templateId"></element>
            <variable value="templateId"></variable>
         </target>
         <target>
            <context value="templateId"></context>
            <contextType value="variable"></contextType>
            <element value="root"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="2.16.756.5.30.1.1.10.4.2"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="TemplateId"></name>
         <source>
            <context value="note"></context>
         </source>
         <target>
            <context value="act"></context>
            <contextType value="variable"></contextType>
            <element value="templateId"></element>
            <variable value="templateId"></variable>
         </target>
         <target>
            <context value="templateId"></context>
            <contextType value="variable"></contextType>
            <element value="root"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="2.16.840.1.113883.10.20.1.40"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="TemplateId"></name>
         <source>
            <context value="note"></context>
         </source>
         <target>
            <context value="act"></context>
            <contextType value="variable"></contextType>
            <element value="templateId"></element>
            <variable value="templateId"></variable>
         </target>
         <target>
            <context value="templateId"></context>
            <contextType value="variable"></contextType>
            <element value="root"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="1.3.6.1.4.1.19376.1.5.3.1.4.2"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="code"></name>
         <source>
            <context value="note"></context>
         </source>
         <target>
            <context value="act"></context>
            <contextType value="variable"></contextType>
            <element value="code"></element>
            <variable value="code"></variable>
         </target>
         <target>
            <context value="code"></context>
            <contextType value="variable"></contextType>
            <element value="code"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="48767-8"></valueString>
            </parameter>
         </target>
         <target>
            <context value="code"></context>
            <contextType value="variable"></contextType>
            <element value="codeSystem"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="2.16.840.1.113883.6.1"></valueString>
            </parameter>
         </target>
         <target>
            <context value="code"></context>
            <contextType value="variable"></contextType>
            <element value="displayName"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="Annotation comment"></valueString>
            </parameter>
         </target>
         <target>
            <context value="code"></context>
            <contextType value="variable"></contextType>
            <element value="codeSystemName"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="LOINC"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="id"></name>
         <source>
            <context value="note"></context>
            <element value="extension"></element>
            <variable value="extension"></variable>
            <condition value="$this.url = 'http://hl7.org/fhir/StructureDefinition/narrativeLink'"></condition>
         </source>
         <rule>
            <name value="reference"></name>
            <source>
               <context value="extension"></context>
               <element value="valueUrl"></element>
               <variable value="valueUrl"></variable>
            </source>
            <target>
               <context value="act"></context>
               <contextType value="variable"></contextType>
               <element value="text"></element>
               <variable value="text"></variable>
            </target>
            <target>
               <context value="text"></context>
               <contextType value="variable"></contextType>
               <element value="reference"></element>
               <variable value="reference"></variable>
            </target>
            <target>
               <context value="reference"></context>
               <contextType value="variable"></contextType>
               <element value="value"></element>
               <transform value="copy"></transform>
               <parameter>
                  <valueId value="valueUrl"></valueId>
               </parameter>
            </target>
         </rule>
      </rule>
      <rule>
         <name value="statuscode"></name>
         <source>
            <context value="note"></context>
         </source>
         <target>
            <context value="act"></context>
            <contextType value="variable"></contextType>
            <element value="statusCode"></element>
            <variable value="code"></variable>
         </target>
         <target>
            <context value="code"></context>
            <contextType value="variable"></contextType>
            <element value="code"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="completed"></valueString>
            </parameter>
         </target>
      </rule>
   </group>
   <group>
      <name value="Substitution"></name>
      <typeMode value="none"></typeMode>
      <input>
         <name value="substitution"></name>
         <type value="Substitution"></type>
         <mode value="source"></mode>
      </input>
      <input>
         <name value="act"></name>
         <type value="Act"></type>
         <mode value="target"></mode>
      </input>
      <rule>
         <name value="ACT"></name>
         <source>
            <context value="substitution"></context>
         </source>
         <target>
            <context value="act"></context>
            <contextType value="variable"></contextType>
            <element value="classCode"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="ACT"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="DEF"></name>
         <source>
            <context value="substitution"></context>
         </source>
         <target>
            <context value="act"></context>
            <contextType value="variable"></contextType>
            <element value="moodCode"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="DEF"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="TemplateId"></name>
         <source>
            <context value="substitution"></context>
         </source>
         <target>
            <context value="act"></context>
            <contextType value="variable"></contextType>
            <element value="templateId"></element>
            <variable value="templateId"></variable>
         </target>
         <target>
            <context value="templateId"></context>
            <contextType value="variable"></contextType>
            <element value="root"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="1.3.6.1.4.1.19376.1.9.1.3.9.1"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="substitution"></name>
         <source>
            <context value="substitution"></context>
            <element value="allowedCodeableConcept"></element>
            <variable value="allowedCC"></variable>
         </source>
         <target>
            <context value="act"></context>
            <contextType value="variable"></contextType>
            <element value="code"></element>
            <variable value="code"></variable>
         </target>
         <dependent>
            <name value="CodeableConceptCE"></name>
            <variable value="allowedCC"></variable>
            <variable value="code"></variable>
         </dependent>
      </rule>
      <rule>
         <name value="status code"></name>
         <source>
            <context value="substitution"></context>
         </source>
         <target>
            <context value="act"></context>
            <contextType value="variable"></contextType>
            <element value="statusCode"></element>
            <variable value="statusCode"></variable>
         </target>
         <target>
            <context value="statusCode"></context>
            <contextType value="variable"></contextType>
            <element value="code"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="completed"></valueString>
            </parameter>
         </target>
      </rule>
   </group>
   <group>
      <name value="PrescribedQuantity"></name>
      <typeMode value="none"></typeMode>
      <input>
         <name value="dispenseRequest"></name>
         <type value="DispenseRequest"></type>
         <mode value="source"></mode>
      </input>
      <input>
         <name value="supply"></name>
         <type value="Supply"></type>
         <mode value="target"></mode>
      </input>
      <rule>
         <name value="SPLY"></name>
         <source>
            <context value="dispenseRequest"></context>
         </source>
         <target>
            <context value="supply"></context>
            <contextType value="variable"></contextType>
            <element value="classCode"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="SPLY"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="RQO"></name>
         <source>
            <context value="dispenseRequest"></context>
         </source>
         <target>
            <context value="supply"></context>
            <contextType value="variable"></contextType>
            <element value="moodCode"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="RQO"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="TemplateId"></name>
         <source>
            <context value="dispenseRequest"></context>
         </source>
         <target>
            <context value="supply"></context>
            <contextType value="variable"></contextType>
            <element value="templateId"></element>
            <variable value="templateId"></variable>
         </target>
         <target>
            <context value="templateId"></context>
            <contextType value="variable"></contextType>
            <element value="root"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="1.3.6.1.4.1.19376.1.9.1.3.8"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="independentInd"></name>
         <source>
            <context value="dispenseRequest"></context>
         </source>
         <target>
            <context value="supply"></context>
            <contextType value="variable"></contextType>
            <element value="independentInd"></element>
            <variable value="independentInd"></variable>
         </target>
         <target>
            <context value="independentInd"></context>
            <contextType value="variable"></contextType>
            <element value="value"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="false"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="quantity"></name>
         <source>
            <context value="dispenseRequest"></context>
            <element value="quantity"></element>
            <variable value="quantity"></variable>
         </source>
         <target>
            <context value="supply"></context>
            <contextType value="variable"></contextType>
            <element value="quantity"></element>
            <variable value="quant"></variable>
         </target>
         <rule>
            <name value="value"></name>
            <source>
               <context value="quantity"></context>
               <element value="value"></element>
               <variable value="value"></variable>
            </source>
            <target>
               <context value="quant"></context>
               <contextType value="variable"></contextType>
               <element value="value"></element>
               <transform value="copy"></transform>
               <parameter>
                  <valueId value="value"></valueId>
               </parameter>
            </target>
         </rule>
      </rule>
   </group>
   <group>
      <name value="PrescribedQuantityUnit"></name>
      <typeMode value="none"></typeMode>
      <input>
         <name value="dispenseRequest"></name>
         <type value="DispenseRequest"></type>
         <mode value="source"></mode>
      </input>
      <input>
         <name value="supply"></name>
         <type value="Supply"></type>
         <mode value="target"></mode>
      </input>
      <rule>
         <name value="SPLY"></name>
         <source>
            <context value="dispenseRequest"></context>
         </source>
         <target>
            <context value="supply"></context>
            <contextType value="variable"></contextType>
            <element value="classCode"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="SPLY"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="RQO"></name>
         <source>
            <context value="dispenseRequest"></context>
         </source>
         <target>
            <context value="supply"></context>
            <contextType value="variable"></contextType>
            <element value="moodCode"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="RQO"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="TemplateId"></name>
         <source>
            <context value="dispenseRequest"></context>
         </source>
         <target>
            <context value="supply"></context>
            <contextType value="variable"></contextType>
            <element value="templateId"></element>
            <variable value="templateId"></variable>
         </target>
         <target>
            <context value="templateId"></context>
            <contextType value="variable"></contextType>
            <element value="root"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="1.3.6.1.4.1.19376.1.9.1.3.8"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="independentInd"></name>
         <source>
            <context value="dispenseRequest"></context>
         </source>
         <target>
            <context value="supply"></context>
            <contextType value="variable"></contextType>
            <element value="independentInd"></element>
            <variable value="independentInd"></variable>
         </target>
         <target>
            <context value="independentInd"></context>
            <contextType value="variable"></contextType>
            <element value="value"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="false"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="quantity"></name>
         <source>
            <context value="dispenseRequest"></context>
            <element value="quantity"></element>
            <variable value="quantity"></variable>
         </source>
         <target>
            <context value="supply"></context>
            <contextType value="variable"></contextType>
            <element value="quantity"></element>
            <variable value="quant"></variable>
         </target>
         <rule>
            <name value="value"></name>
            <source>
               <context value="quantity"></context>
               <element value="value"></element>
               <variable value="value"></variable>
            </source>
            <target>
               <context value="quant"></context>
               <contextType value="variable"></contextType>
               <element value="value"></element>
               <transform value="copy"></transform>
               <parameter>
                  <valueId value="value"></valueId>
               </parameter>
            </target>
         </rule>
         <rule>
            <name value="unit"></name>
            <source>
               <context value="quantity"></context>
               <element value="unit"></element>
               <variable value="unit"></variable>
            </source>
            <target>
               <context value="quant"></context>
               <contextType value="variable"></contextType>
               <element value="unit"></element>
               <transform value="copy"></transform>
               <parameter>
                  <valueId value="unit"></valueId>
               </parameter>
            </target>
         </rule>
      </rule>
   </group>
   <group>
      <name value="ManufacturedMaterialEntryContentModule"></name>
      <typeMode value="none"></typeMode>
      <input>
         <name value="bundle"></name>
         <type value="Bundle"></type>
         <mode value="source"></mode>
      </input>
      <input>
         <name value="medicationRequest"></name>
         <type value="MedicationRequest"></type>
         <mode value="source"></mode>
      </input>
      <input>
         <name value="medication"></name>
         <type value="Medication"></type>
         <mode value="source"></mode>
      </input>
      <input>
         <name value="manufacturedMaterial"></name>
         <type value="ManufacturedMaterial"></type>
         <mode value="target"></mode>
      </input>
      <input>
         <name value="substanceAdministration"></name>
         <type value="SubstanceAdministration"></type>
         <mode value="target"></mode>
      </input>
      <rule>
         <name value="MMAT"></name>
         <source>
            <context value="medication"></context>
         </source>
         <target>
            <context value="manufacturedMaterial"></context>
            <contextType value="variable"></contextType>
            <element value="classCode"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="MMAT"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="KIND"></name>
         <source>
            <context value="medication"></context>
         </source>
         <target>
            <context value="manufacturedMaterial"></context>
            <contextType value="variable"></contextType>
            <element value="determinerCode"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="KIND"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="CH-PHARM Manufactured Material Content Modul"></name>
         <source>
            <context value="medication"></context>
         </source>
         <target>
            <context value="manufacturedMaterial"></context>
            <contextType value="variable"></contextType>
            <element value="templateId"></element>
            <variable value="templateId"></variable>
         </target>
         <target>
            <context value="templateId"></context>
            <contextType value="variable"></contextType>
            <element value="root"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="2.16.756.5.30.1.1.10.4.33"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="TemplateId"></name>
         <source>
            <context value="medication"></context>
         </source>
         <target>
            <context value="manufacturedMaterial"></context>
            <contextType value="variable"></contextType>
            <element value="templateId"></element>
            <variable value="templateId"></variable>
         </target>
         <target>
            <context value="templateId"></context>
            <contextType value="variable"></contextType>
            <element value="root"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="1.3.6.1.4.1.19376.1.9.1.3.1"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="name"></name>
         <source>
            <context value="medication"></context>
            <element value="code"></element>
            <variable value="code"></variable>
         </source>
         <rule>
            <name value="brandname"></name>
            <source>
               <context value="code"></context>
               <element value="text"></element>
               <variable value="text"></variable>
            </source>
            <target>
               <context value="manufacturedMaterial"></context>
               <contextType value="variable"></contextType>
               <element value="name"></element>
               <variable value="name"></variable>
            </target>
            <target>
               <context value="name"></context>
               <contextType value="variable"></contextType>
               <element value="other"></element>
               <transform value="copy"></transform>
               <parameter>
                  <valueId value="text"></valueId>
               </parameter>
            </target>
         </rule>
      </rule>
      <rule>
         <name value="code"></name>
         <source>
            <context value="medication"></context>
            <element value="code"></element>
            <variable value="code"></variable>
         </source>
         <rule>
            <name value="id"></name>
            <source>
               <context value="code"></context>
               <element value="extension"></element>
               <variable value="extension"></variable>
               <condition value="$this.url = 'http://hl7.org/fhir/StructureDefinition/narrativeLink'"></condition>
            </source>
            <target>
               <context value="manufacturedMaterial"></context>
               <contextType value="variable"></contextType>
               <element value="code"></element>
               <variable value="code"></variable>
            </target>
            <rule>
               <name value="reference"></name>
               <source>
                  <context value="extension"></context>
                  <element value="valueUrl"></element>
                  <variable value="valueUrl"></variable>
               </source>
               <target>
                  <context value="code"></context>
                  <contextType value="variable"></contextType>
                  <element value="originalText"></element>
                  <variable value="text"></variable>
               </target>
               <target>
                  <context value="text"></context>
                  <contextType value="variable"></contextType>
                  <element value="reference"></element>
                  <variable value="reference"></variable>
               </target>
               <target>
                  <context value="reference"></context>
                  <contextType value="variable"></contextType>
                  <element value="value"></element>
                  <transform value="copy"></transform>
                  <parameter>
                     <valueId value="valueUrl"></valueId>
                  </parameter>
               </target>
            </rule>
         </rule>
         <rule>
            <name value="code"></name>
            <source>
               <context value="code"></context>
               <element value="coding"></element>
               <variable value="coding"></variable>
            </source>
            <target>
               <context value="manufacturedMaterial"></context>
               <contextType value="variable"></contextType>
               <element value="code"></element>
               <variable value="ce"></variable>
            </target>
            <dependent>
               <name value="CodingCE"></name>
               <variable value="coding"></variable>
               <variable value="ce"></variable>
            </dependent>
         </rule>
         <documentation value="#pre.no.brandedmedication"></documentation>
      </rule>
      <rule>
         <name value="form"></name>
         <source>
            <context value="medication"></context>
            <element value="form"></element>
            <variable value="form"></variable>
         </source>
         <rule>
            <name value="formCode"></name>
            <source>
               <context value="form"></context>
               <element value="coding"></element>
               <variable value="coding"></variable>
            </source>
            <target>
               <context value="manufacturedMaterial"></context>
               <contextType value="variable"></contextType>
               <element value="formCode"></element>
               <variable value="formCode"></variable>
            </target>
            <dependent>
               <name value="CodingCE"></name>
               <variable value="coding"></variable>
               <variable value="formCode"></variable>
            </dependent>
         </rule>
      </rule>
      <rule>
         <name value="code"></name>
         <source>
            <context value="medication"></context>
            <element value="code"></element>
            <variable value="code"></variable>
         </source>
         <target>
            <context value="manufacturedMaterial"></context>
            <contextType value="variable"></contextType>
            <element value="asContent"></element>
            <variable value="asContent"></variable>
         </target>
         <target>
            <context value="asContent"></context>
            <contextType value="variable"></contextType>
            <element value="classCode"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="CONT"></valueString>
            </parameter>
         </target>
         <target>
            <context value="asContent"></context>
            <contextType value="variable"></contextType>
            <element value="containerPackagedMedicine"></element>
            <variable value="containerPackagedMedicine"></variable>
         </target>
         <rule>
            <name value="CONT"></name>
            <source>
               <context value="code"></context>
            </source>
            <target>
               <context value="containerPackagedMedicine"></context>
               <contextType value="variable"></contextType>
               <element value="classCode"></element>
               <transform value="copy"></transform>
               <parameter>
                  <valueString value="CONT"></valueString>
               </parameter>
            </target>
         </rule>
         <rule>
            <name value="INSTANCE"></name>
            <source>
               <context value="code"></context>
            </source>
            <target>
               <context value="containerPackagedMedicine"></context>
               <contextType value="variable"></contextType>
               <element value="determinerCode"></element>
               <transform value="copy"></transform>
               <parameter>
                  <valueString value="INSTANCE"></valueString>
               </parameter>
            </target>
         </rule>
         <rule>
            <name value="pharm:code"></name>
            <source>
               <context value="code"></context>
               <element value="coding"></element>
               <variable value="coding"></variable>
            </source>
            <target>
               <context value="containerPackagedMedicine"></context>
               <contextType value="variable"></contextType>
               <element value="code"></element>
               <variable value="ce"></variable>
            </target>
            <dependent>
               <name value="CodingCE"></name>
               <variable value="coding"></variable>
               <variable value="ce"></variable>
            </dependent>
         </rule>
         <rule>
            <name value="pharm:name"></name>
            <source>
               <context value="code"></context>
               <element value="text"></element>
               <variable value="text"></variable>
            </source>
            <target>
               <context value="containerPackagedMedicine"></context>
               <contextType value="variable"></contextType>
               <element value="name"></element>
               <variable value="name"></variable>
            </target>
            <target>
               <context value="name"></context>
               <contextType value="variable"></contextType>
               <element value="other"></element>
               <transform value="copy"></transform>
               <parameter>
                  <valueId value="text"></valueId>
               </parameter>
            </target>
         </rule>
         <rule>
            <name value="form"></name>
            <source>
               <context value="medication"></context>
               <element value="form"></element>
               <variable value="form"></variable>
            </source>
            <rule>
               <name value="pharm:formCode"></name>
               <source>
                  <context value="form"></context>
                  <element value="coding"></element>
                  <variable value="coding"></variable>
               </source>
               <target>
                  <context value="containerPackagedMedicine"></context>
                  <contextType value="variable"></contextType>
                  <element value="formCode"></element>
                  <variable value="formCode"></variable>
               </target>
               <dependent>
                  <name value="CodingCE"></name>
                  <variable value="coding"></variable>
                  <variable value="formCode"></variable>
               </dependent>
            </rule>
         </rule>
         <rule>
            <name value="amount"></name>
            <source>
               <context value="medication"></context>
               <element value="amount"></element>
               <variable value="amount"></variable>
            </source>
            <rule>
               <name value="numerator"></name>
               <source>
                  <context value="amount"></context>
                  <element value="numerator"></element>
                  <variable value="numerator"></variable>
               </source>
               <rule>
                  <name value="no UCUM"></name>
                  <source>
                     <context value="numerator"></context>
                     <element value="code"></element>
                     <variable value="code"></variable>
                     <condition value="$this = '1'"></condition>
                  </source>
                  <target>
                     <context value="containerPackagedMedicine"></context>
                     <contextType value="variable"></contextType>
                     <element value="capacityQuantity"></element>
                     <variable value="capacityQuantity"></variable>
                  </target>
                  <rule>
                     <name value="value"></name>
                     <source>
                        <context value="numerator"></context>
                        <element value="value"></element>
                        <variable value="value"></variable>
                     </source>
                     <target>
                        <context value="capacityQuantity"></context>
                        <contextType value="variable"></contextType>
                        <element value="value"></element>
                        <transform value="copy"></transform>
                        <parameter>
                           <valueId value="value"></valueId>
                        </parameter>
                     </target>
                  </rule>
               </rule>
               <rule>
                  <name value="UCUM"></name>
                  <source>
                     <context value="numerator"></context>
                     <element value="code"></element>
                     <variable value="code"></variable>
                     <condition value="$this != '1'"></condition>
                  </source>
                  <target>
                     <context value="containerPackagedMedicine"></context>
                     <contextType value="variable"></contextType>
                     <element value="capacityQuantity"></element>
                     <variable value="capacityQuantity"></variable>
                  </target>
                  <rule>
                     <name value="value"></name>
                     <source>
                        <context value="numerator"></context>
                        <element value="value"></element>
                        <variable value="value"></variable>
                     </source>
                     <target>
                        <context value="capacityQuantity"></context>
                        <contextType value="variable"></contextType>
                        <element value="value"></element>
                        <transform value="copy"></transform>
                        <parameter>
                           <valueId value="value"></valueId>
                        </parameter>
                     </target>
                  </rule>
                  <rule>
                     <name value="unit"></name>
                     <source>
                        <context value="numerator"></context>
                        <element value="unit"></element>
                        <variable value="unit"></variable>
                     </source>
                     <target>
                        <context value="capacityQuantity"></context>
                        <contextType value="variable"></contextType>
                        <element value="unit"></element>
                        <transform value="copy"></transform>
                        <parameter>
                           <valueId value="unit"></valueId>
                        </parameter>
                     </target>
                  </rule>
               </rule>
               <rule>
                  <name value="no UCUM"></name>
                  <source>
                     <context value="numerator"></context>
                     <variable value="numerator"></variable>
                     <condition value="$this.code.exists() = false"></condition>
                  </source>
                  <target>
                     <context value="containerPackagedMedicine"></context>
                     <contextType value="variable"></contextType>
                     <element value="capacityQuantity"></element>
                     <variable value="capacityQuantity"></variable>
                  </target>
                  <rule>
                     <name value="value"></name>
                     <source>
                        <context value="numerator"></context>
                        <element value="value"></element>
                        <variable value="value"></variable>
                     </source>
                     <target>
                        <context value="capacityQuantity"></context>
                        <contextType value="variable"></contextType>
                        <element value="value"></element>
                        <transform value="copy"></transform>
                        <parameter>
                           <valueId value="value"></valueId>
                        </parameter>
                     </target>
                  </rule>
               </rule>
               <documentation value="if the value of numerator.code is &quot;1&quot;, then it is not a UCUM code, so generate case 1"></documentation>
            </rule>
            <rule>
               <name value="PrescribedQuantity"></name>
               <source>
                  <context value="medicationRequest"></context>
                  <element value="dispenseRequest"></element>
                  <variable value="dispenseRequest"></variable>
               </source>
               <target>
                  <context value="substanceAdministration"></context>
                  <contextType value="variable"></contextType>
                  <element value="entryRelationship"></element>
                  <variable value="entryRelationship"></variable>
               </target>
               <target>
                  <context value="entryRelationship"></context>
                  <contextType value="variable"></contextType>
                  <element value="typeCode"></element>
                  <transform value="copy"></transform>
                  <parameter>
                     <valueString value="COMP"></valueString>
                  </parameter>
               </target>
               <target>
                  <context value="entryRelationship"></context>
                  <contextType value="variable"></contextType>
                  <element value="supply"></element>
                  <variable value="supply"></variable>
               </target>
               <dependent>
                  <name value="PrescribedQuantity"></name>
                  <variable value="dispenseRequest"></variable>
                  <variable value="supply"></variable>
               </dependent>
            </rule>
         </rule>
         <rule>
            <name value="no amount"></name>
            <source>
               <context value="medication"></context>
               <condition value="$this.amount.exists() = false"></condition>
            </source>
            <rule>
               <name value="PrescribedQuantityUnit"></name>
               <source>
                  <context value="medicationRequest"></context>
                  <element value="dispenseRequest"></element>
                  <variable value="dispenseRequest"></variable>
               </source>
               <target>
                  <context value="substanceAdministration"></context>
                  <contextType value="variable"></contextType>
                  <element value="entryRelationship"></element>
                  <variable value="entryRelationship"></variable>
               </target>
               <target>
                  <context value="entryRelationship"></context>
                  <contextType value="variable"></contextType>
                  <element value="typeCode"></element>
                  <transform value="copy"></transform>
                  <parameter>
                     <valueString value="COMP"></valueString>
                  </parameter>
               </target>
               <target>
                  <context value="entryRelationship"></context>
                  <contextType value="variable"></contextType>
                  <element value="supply"></element>
                  <variable value="supply"></variable>
               </target>
               <dependent>
                  <name value="PrescribedQuantityUnit"></name>
                  <variable value="dispenseRequest"></variable>
                  <variable value="supply"></variable>
               </dependent>
            </rule>
         </rule>
      </rule>
      <rule>
         <name value="ingredient"></name>
         <source>
            <context value="medication"></context>
            <element value="ingredient"></element>
            <variable value="ingredient"></variable>
         </source>
         <target>
            <context value="manufacturedMaterial"></context>
            <contextType value="variable"></contextType>
            <element value="ingredient"></element>
            <variable value="ingredient"></variable>
         </target>
         <target>
            <context value="ingredient"></context>
            <contextType value="variable"></contextType>
            <element value="classCode"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="ACTI"></valueString>
            </parameter>
         </target>
         <rule>
            <name value="PharmSubstance"></name>
            <source>
               <context value="ingredient"></context>
               <element value="itemCodeableConcept"></element>
               <variable value="itemCodeableConcept"></variable>
            </source>
            <target>
               <context value="ingredient"></context>
               <contextType value="variable"></contextType>
               <element value="ingredient"></element>
               <variable value="pharmsubstance"></variable>
            </target>
            <rule>
               <name value="MMAT"></name>
               <source>
                  <context value="itemCodeableConcept"></context>
               </source>
               <target>
                  <context value="pharmsubstance"></context>
                  <contextType value="variable"></contextType>
                  <element value="classCode"></element>
                  <transform value="copy"></transform>
                  <parameter>
                     <valueString value="MMAT"></valueString>
                  </parameter>
               </target>
            </rule>
            <rule>
               <name value="KIND"></name>
               <source>
                  <context value="itemCodeableConcept"></context>
               </source>
               <target>
                  <context value="pharmsubstance"></context>
                  <contextType value="variable"></contextType>
                  <element value="determinerCode"></element>
                  <transform value="copy"></transform>
                  <parameter>
                     <valueString value="KIND"></valueString>
                  </parameter>
               </target>
            </rule>
            <rule>
               <name value="name"></name>
               <source>
                  <context value="itemCodeableConcept"></context>
                  <element value="text"></element>
                  <variable value="text"></variable>
               </source>
               <target>
                  <context value="pharmsubstance"></context>
                  <contextType value="variable"></contextType>
                  <element value="name"></element>
                  <variable value="name"></variable>
               </target>
               <target>
                  <context value="name"></context>
                  <contextType value="variable"></contextType>
                  <element value="other"></element>
                  <transform value="copy"></transform>
                  <parameter>
                     <valueId value="text"></valueId>
                  </parameter>
               </target>
            </rule>
            <rule>
               <name value="coding"></name>
               <source>
                  <context value="itemCodeableConcept"></context>
                  <element value="coding"></element>
                  <variable value="coding"></variable>
               </source>
               <rule>
                  <name value="formCode"></name>
                  <source>
                     <context value="coding"></context>
                  </source>
                  <target>
                     <context value="pharmsubstance"></context>
                     <contextType value="variable"></contextType>
                     <element value="code"></element>
                     <variable value="ce"></variable>
                  </target>
                  <dependent>
                     <name value="CodingCE"></name>
                     <variable value="coding"></variable>
                     <variable value="ce"></variable>
                  </dependent>
               </rule>
            </rule>
         </rule>
         <rule>
            <name value="strength"></name>
            <source>
               <context value="ingredient"></context>
               <element value="strength"></element>
               <variable value="strength"></variable>
            </source>
            <target>
               <context value="ingredient"></context>
               <contextType value="variable"></contextType>
               <element value="quantity"></element>
               <variable value="quantity"></variable>
            </target>
            <dependent>
               <name value="RatioRTOPQPQ"></name>
               <variable value="strength"></variable>
               <variable value="quantity"></variable>
            </dependent>
         </rule>
      </rule>
   </group>
   <group>
      <name value="PrescriptionItemEntryContentModule"></name>
      <typeMode value="none"></typeMode>
      <input>
         <name value="bundle"></name>
         <type value="Bundle"></type>
         <mode value="source"></mode>
      </input>
      <input>
         <name value="medicationRequest"></name>
         <type value="MedicationRequest"></type>
         <mode value="source"></mode>
      </input>
      <input>
         <name value="substanceAdministration"></name>
         <type value="SubstanceAdministration"></type>
         <mode value="target"></mode>
      </input>
      <rule>
         <name value="SBADM"></name>
         <source>
            <context value="medicationRequest"></context>
         </source>
         <target>
            <context value="substanceAdministration"></context>
            <contextType value="variable"></contextType>
            <element value="classCode"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="SBADM"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="INT"></name>
         <source>
            <context value="medicationRequest"></context>
         </source>
         <target>
            <context value="substanceAdministration"></context>
            <contextType value="variable"></contextType>
            <element value="moodCode"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="INT"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="CH-PHARM Prescription Item Entry Content Module"></name>
         <source>
            <context value="medicationRequest"></context>
         </source>
         <target>
            <context value="substanceAdministration"></context>
            <contextType value="variable"></contextType>
            <element value="templateId"></element>
            <variable value="templateId"></variable>
         </target>
         <target>
            <context value="templateId"></context>
            <contextType value="variable"></contextType>
            <element value="root"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="2.16.756.5.30.1.1.10.4.43"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="Prescription Item Entry TemplateID"></name>
         <source>
            <context value="medicationRequest"></context>
         </source>
         <target>
            <context value="substanceAdministration"></context>
            <contextType value="variable"></contextType>
            <element value="templateId"></element>
            <variable value="templateId"></variable>
         </target>
         <target>
            <context value="templateId"></context>
            <contextType value="variable"></contextType>
            <element value="root"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="1.3.6.1.4.1.19376.1.9.1.3.2"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="CCD"></name>
         <source>
            <context value="medicationRequest"></context>
         </source>
         <target>
            <context value="substanceAdministration"></context>
            <contextType value="variable"></contextType>
            <element value="templateId"></element>
            <variable value="templateId"></variable>
         </target>
         <target>
            <context value="templateId"></context>
            <contextType value="variable"></contextType>
            <element value="root"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="2.16.840.1.113883.10.20.1.24"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="PCC Medication Entry Content Module"></name>
         <source>
            <context value="medicationRequest"></context>
         </source>
         <target>
            <context value="substanceAdministration"></context>
            <contextType value="variable"></contextType>
            <element value="templateId"></element>
            <variable value="templateId"></variable>
         </target>
         <target>
            <context value="templateId"></context>
            <contextType value="variable"></contextType>
            <element value="root"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="1.3.6.1.4.1.19376.1.5.3.1.4.7"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="id"></name>
         <source>
            <context value="medicationRequest"></context>
            <element value="identifier"></element>
            <variable value="identifier"></variable>
         </source>
         <target>
            <context value="substanceAdministration"></context>
            <contextType value="variable"></contextType>
            <element value="id"></element>
            <variable value="id"></variable>
         </target>
         <dependent>
            <name value="IdentifierII"></name>
            <variable value="identifier"></variable>
            <variable value="id"></variable>
         </dependent>
      </rule>
      <rule>
         <name value="narrativeLink"></name>
         <source>
            <context value="medicationRequest"></context>
            <element value="extension"></element>
            <variable value="extension"></variable>
            <condition value="$this.url = 'http://hl7.org/fhir/StructureDefinition/narrativeLink'"></condition>
         </source>
         <target>
            <context value="substanceAdministration"></context>
            <contextType value="variable"></contextType>
            <element value="text"></element>
            <variable value="text"></variable>
         </target>
         <target>
            <context value="text"></context>
            <contextType value="variable"></contextType>
            <element value="reference"></element>
            <variable value="reference"></variable>
         </target>
         <rule>
            <name value="valueUrl"></name>
            <source>
               <context value="extension"></context>
               <element value="valueUrl"></element>
               <variable value="valueUrl"></variable>
            </source>
            <target>
               <context value="reference"></context>
               <contextType value="variable"></contextType>
               <element value="value"></element>
               <transform value="copy"></transform>
               <parameter>
                  <valueId value="valueUrl"></valueId>
               </parameter>
            </target>
         </rule>
      </rule>
      <rule>
         <name value="code"></name>
         <source>
            <context value="medicationRequest"></context>
         </source>
         <target>
            <context value="substanceAdministration"></context>
            <contextType value="variable"></contextType>
            <element value="statusCode"></element>
            <variable value="statusCode"></variable>
         </target>
         <target>
            <context value="statusCode"></context>
            <contextType value="variable"></contextType>
            <element value="code"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="completed"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="dispense request"></name>
         <source>
            <context value="medicationRequest"></context>
            <element value="dispenseRequest"></element>
            <variable value="dispenseRequest"></variable>
         </source>
         <target>
            <context value="substanceAdministration"></context>
            <contextType value="variable"></contextType>
            <element value="repeatNumber"></element>
            <variable value="repeatNumber"></variable>
         </target>
         <rule>
            <name value="repeat number"></name>
            <source>
               <context value="dispenseRequest"></context>
               <element value="numberOfRepeatsAllowed"></element>
               <variable value="number"></variable>
            </source>
            <target>
               <context value="repeatNumber"></context>
               <contextType value="variable"></contextType>
               <element value="value"></element>
               <transform value="copy"></transform>
               <parameter>
                  <valueId value="number"></valueId>
               </parameter>
            </target>
         </rule>
      </rule>
      <rule>
         <name value="contained"></name>
         <source>
            <context value="medicationRequest"></context>
            <element value="contained"></element>
            <variable value="medication"></variable>
            <condition value="('#' + $this.id) in %medicationRequest.medicationReference.reference"></condition>
         </source>
         <target>
            <context value="substanceAdministration"></context>
            <contextType value="variable"></contextType>
            <element value="consumable"></element>
            <variable value="consumable"></variable>
         </target>
         <target>
            <context value="consumable"></context>
            <contextType value="variable"></contextType>
            <element value="manufacturedProduct"></element>
            <variable value="manufacturedProduct"></variable>
         </target>
         <target>
            <context value="manufacturedProduct"></context>
            <contextType value="variable"></contextType>
            <element value="classCode"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="MANU"></valueString>
            </parameter>
         </target>
         <rule>
            <name value="MP TemplateId"></name>
            <source>
               <context value="medication"></context>
            </source>
            <target>
               <context value="manufacturedProduct"></context>
               <contextType value="variable"></contextType>
               <element value="templateId"></element>
               <variable value="templateId"></variable>
            </target>
            <target>
               <context value="templateId"></context>
               <contextType value="variable"></contextType>
               <element value="root"></element>
               <transform value="copy"></transform>
               <parameter>
                  <valueString value="1.3.6.1.4.1.19376.1.5.3.1.4.7.2"></valueString>
               </parameter>
            </target>
         </rule>
         <rule>
            <name value="MP TemplateId"></name>
            <source>
               <context value="medication"></context>
            </source>
            <target>
               <context value="manufacturedProduct"></context>
               <contextType value="variable"></contextType>
               <element value="templateId"></element>
               <variable value="templateId"></variable>
            </target>
            <target>
               <context value="templateId"></context>
               <contextType value="variable"></contextType>
               <element value="root"></element>
               <transform value="copy"></transform>
               <parameter>
                  <valueString value="2.16.840.1.113883.10.20.1.53"></valueString>
               </parameter>
            </target>
         </rule>
         <rule>
            <name value="manufacturedMaterial"></name>
            <source>
               <context value="medication"></context>
            </source>
            <target>
               <context value="manufacturedProduct"></context>
               <contextType value="variable"></contextType>
               <element value="manufacturedMaterial"></element>
               <variable value="manufacturedMaterial"></variable>
            </target>
            <dependent>
               <name value="ManufacturedMaterialEntryContentModule"></name>
               <variable value="bundle"></variable>
               <variable value="medicationRequest"></variable>
               <variable value="medication"></variable>
               <variable value="manufacturedMaterial"></variable>
               <variable value="substanceAdministration"></variable>
            </dependent>
         </rule>
      </rule>
      <rule>
         <name value="DosageSubstanceAdministration"></name>
         <source>
            <context value="medicationRequest"></context>
            <element value="dosageInstruction"></element>
            <variable value="dosage"></variable>
            <condition value="$this.conformsTo('http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-dosage-structured-medicationrequest') and $this.sequence.empty()"></condition>
         </source>
         <dependent>
            <name value="DosageInstructionsStartStopFrequency"></name>
            <variable value="dosage"></variable>
            <variable value="substanceAdministration"></variable>
         </dependent>
      </rule>
      <rule>
         <name value="DosageSubstanceAdministration"></name>
         <source>
            <context value="medicationRequest"></context>
            <element value="dosageInstruction"></element>
            <listMode value="first"></listMode>
            <variable value="dosage"></variable>
            <condition value="$this.conformsTo('http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-dosage-structured-medicationrequest') and $this.sequence.exists()"></condition>
         </source>
         <target>
            <context value="substanceAdministration"></context>
            <contextType value="variable"></contextType>
            <element value="entryRelationship"></element>
            <variable value="entryRelationship"></variable>
         </target>
         <dependent>
            <name value="DosageInstructionsEntryStartStopRoute"></name>
            <variable value="dosage"></variable>
            <variable value="substanceAdministration"></variable>
            <variable value="entryRelationship"></variable>
         </dependent>
      </rule>
      <rule>
         <name value="DosageSubstanceAdministration"></name>
         <source>
            <context value="medicationRequest"></context>
            <element value="dosageInstruction"></element>
            <variable value="dosage"></variable>
            <condition value="$this.conformsTo('http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-dosage-structured-medicationrequest') and $this.sequence.exists()"></condition>
         </source>
         <target>
            <context value="substanceAdministration"></context>
            <contextType value="variable"></contextType>
            <element value="entryRelationship"></element>
            <variable value="entryRelationship"></variable>
         </target>
         <target>
            <context value="entryRelationship"></context>
            <contextType value="variable"></contextType>
            <element value="typeCode"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="COMP"></valueString>
            </parameter>
         </target>
         <dependent>
            <name value="DosageInstructionsEntryDosageChange"></name>
            <variable value="dosage"></variable>
            <variable value="substanceAdministration"></variable>
            <variable value="entryRelationship"></variable>
         </dependent>
      </rule>
      <rule>
         <name value="TreatmentReasonEntryContentModule"></name>
         <source>
            <context value="medicationRequest"></context>
            <element value="reasonCode"></element>
            <variable value="reasonCode"></variable>
         </source>
         <target>
            <context value="substanceAdministration"></context>
            <contextType value="variable"></contextType>
            <element value="entryRelationship"></element>
            <variable value="entryRelationship"></variable>
         </target>
         <target>
            <context value="entryRelationship"></context>
            <contextType value="variable"></contextType>
            <element value="typeCode"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="RSON"></valueString>
            </parameter>
         </target>
         <target>
            <context value="entryRelationship"></context>
            <contextType value="variable"></contextType>
            <element value="observation"></element>
            <variable value="observation"></variable>
         </target>
         <dependent>
            <name value="TreatmentReasonEntryContentModule"></name>
            <variable value="reasonCode"></variable>
            <variable value="observation"></variable>
         </dependent>
      </rule>
      <rule>
         <name value="MTP Reference"></name>
         <source>
            <context value="medicationRequest"></context>
            <element value="extension"></element>
            <variable value="extension"></variable>
            <condition value="url = 'http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-ext-treatmentplan'"></condition>
         </source>
         <target>
            <context value="substanceAdministration"></context>
            <contextType value="variable"></contextType>
            <element value="entryRelationship"></element>
            <variable value="entryRelationship"></variable>
         </target>
         <target>
            <context value="entryRelationship"></context>
            <contextType value="variable"></contextType>
            <element value="typeCode"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="REFR"></valueString>
            </parameter>
         </target>
         <target>
            <context value="entryRelationship"></context>
            <contextType value="variable"></contextType>
            <element value="substanceAdministration"></element>
            <variable value="substanceAdministration"></variable>
         </target>
         <dependent>
            <name value="MTPReferenceEntryContentModule"></name>
            <variable value="extension"></variable>
            <variable value="substanceAdministration"></variable>
         </dependent>
      </rule>
      <rule>
         <name value="DosageInstructionsNonStructuredEntryContentModule"></name>
         <source>
            <context value="medicationRequest"></context>
            <element value="dosageInstruction"></element>
            <variable value="dosage"></variable>
            <condition value="$this.conformsTo('http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-dosage-nonstructured')"></condition>
         </source>
         <target>
            <context value="substanceAdministration"></context>
            <contextType value="variable"></contextType>
            <element value="entryRelationship"></element>
            <variable value="entryRelationship"></variable>
         </target>
         <target>
            <context value="entryRelationship"></context>
            <contextType value="variable"></contextType>
            <element value="typeCode"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="COMP"></valueString>
            </parameter>
         </target>
         <target>
            <context value="entryRelationship"></context>
            <contextType value="variable"></contextType>
            <element value="substanceAdministration"></element>
            <variable value="substanceAdministration"></variable>
         </target>
         <dependent>
            <name value="DosageInstructionsNonStructuredEntryContentModule"></name>
            <variable value="dosage"></variable>
            <variable value="substanceAdministration"></variable>
         </dependent>
      </rule>
      <rule>
         <name value="AnnotationComment"></name>
         <source>
            <context value="medicationRequest"></context>
            <element value="note"></element>
            <variable value="note"></variable>
         </source>
         <target>
            <context value="substanceAdministration"></context>
            <contextType value="variable"></contextType>
            <element value="entryRelationship"></element>
            <variable value="entryRelationship"></variable>
         </target>
         <target>
            <context value="entryRelationship"></context>
            <contextType value="variable"></contextType>
            <element value="typeCode"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="COMP"></valueString>
            </parameter>
         </target>
         <target>
            <context value="entryRelationship"></context>
            <contextType value="variable"></contextType>
            <element value="act"></element>
            <variable value="act"></variable>
         </target>
         <dependent>
            <name value="AnnotationComment"></name>
            <variable value="note"></variable>
            <variable value="act"></variable>
         </dependent>
      </rule>
      <rule>
         <name value="Substitution"></name>
         <source>
            <context value="medicationRequest"></context>
            <element value="substitution"></element>
            <variable value="substitution"></variable>
         </source>
         <target>
            <context value="substanceAdministration"></context>
            <contextType value="variable"></contextType>
            <element value="entryRelationship"></element>
            <variable value="entryRelationship"></variable>
         </target>
         <target>
            <context value="entryRelationship"></context>
            <contextType value="variable"></contextType>
            <element value="typeCode"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="COMP"></valueString>
            </parameter>
         </target>
         <target>
            <context value="entryRelationship"></context>
            <contextType value="variable"></contextType>
            <element value="act"></element>
            <variable value="act"></variable>
         </target>
         <dependent>
            <name value="Substitution"></name>
            <variable value="substitution"></variable>
            <variable value="act"></variable>
         </dependent>
      </rule>
   </group>
   <group>
      <name value="DosageInstructionsStartStopFrequency"></name>
      <typeMode value="none"></typeMode>
      <input>
         <name value="dosage"></name>
         <type value="Dosage"></type>
         <mode value="source"></mode>
      </input>
      <input>
         <name value="substanceAdministration"></name>
         <type value="SubstanceAdministration"></type>
         <mode value="target"></mode>
      </input>
      <rule>
         <name value="Normal Dose"></name>
         <source>
            <context value="dosage"></context>
         </source>
         <target>
            <context value="substanceAdministration"></context>
            <contextType value="variable"></contextType>
            <element value="templateId"></element>
            <variable value="templateId"></variable>
         </target>
         <target>
            <context value="templateId"></context>
            <contextType value="variable"></contextType>
            <element value="root"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="1.3.6.1.4.1.19376.1.5.3.1.4.7.1"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="effective time start end"></name>
         <source>
            <context value="dosage"></context>
            <variable value="dosage"></variable>
         </source>
         <target>
            <variable value="substanceAdministration"></variable>
            <transform value="copy"></transform>
            <parameter>
               <valueId value="substanceAdministration"></valueId>
            </parameter>
         </target>
         <dependent>
            <name value="EffectiveTimeStartEnd"></name>
            <variable value="dosage"></variable>
            <variable value="substanceAdministration"></variable>
         </dependent>
      </rule>
      <rule>
         <name value="effective time when"></name>
         <source>
            <context value="dosage"></context>
            <variable value="dosage"></variable>
         </source>
         <target>
            <variable value="substanceAdministration"></variable>
            <transform value="copy"></transform>
            <parameter>
               <valueId value="substanceAdministration"></valueId>
            </parameter>
         </target>
         <dependent>
            <name value="EffectiveTimeWhen"></name>
            <variable value="dosage"></variable>
            <variable value="substanceAdministration"></variable>
         </dependent>
      </rule>
      <rule>
         <name value="route"></name>
         <source>
            <context value="dosage"></context>
            <element value="route"></element>
            <variable value="route"></variable>
         </source>
         <target>
            <context value="substanceAdministration"></context>
            <contextType value="variable"></contextType>
            <element value="routeCode"></element>
            <variable value="routeCode"></variable>
         </target>
         <dependent>
            <name value="CodeableConceptCE"></name>
            <variable value="route"></variable>
            <variable value="routeCode"></variable>
         </dependent>
      </rule>
      <rule>
         <name value="dose quantity"></name>
         <source>
            <context value="dosage"></context>
            <variable value="dosage"></variable>
         </source>
         <target>
            <variable value="substanceAdministration"></variable>
            <transform value="copy"></transform>
            <parameter>
               <valueId value="substanceAdministration"></valueId>
            </parameter>
         </target>
         <dependent>
            <name value="DoseQuantity"></name>
            <variable value="dosage"></variable>
            <variable value="substanceAdministration"></variable>
         </dependent>
      </rule>
   </group>
   <group>
      <name value="DosageInstructionsEntryStartStopRoute"></name>
      <typeMode value="none"></typeMode>
      <input>
         <name value="dosage"></name>
         <type value="Dosage"></type>
         <mode value="source"></mode>
      </input>
      <input>
         <name value="substanceAdministration"></name>
         <type value="substanceAdministration"></type>
         <mode value="target"></mode>
      </input>
      <input>
         <name value="entry"></name>
         <type value="entryRelationship"></type>
         <mode value="target"></mode>
      </input>
      <rule>
         <name value="extension"></name>
         <source>
            <context value="dosage"></context>
            <element value="extension"></element>
            <variable value="extension"></variable>
            <condition value="$this.url = 'http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-ext-dosagetype'"></condition>
         </source>
         <rule>
            <name value="valueIdentifier"></name>
            <source>
               <context value="extension"></context>
               <element value="valueIdentifier"></element>
               <variable value="valueIdentifier"></variable>
            </source>
            <rule>
               <name value="template id"></name>
               <source>
                  <context value="valueIdentifier"></context>
                  <element value="value"></element>
                  <variable value="value"></variable>
               </source>
               <target>
                  <context value="substanceAdministration"></context>
                  <contextType value="variable"></contextType>
                  <element value="templateId"></element>
                  <variable value="templateId"></variable>
               </target>
               <target>
                  <context value="templateId"></context>
                  <contextType value="variable"></contextType>
                  <element value="root"></element>
                  <transform value="copy"></transform>
                  <parameter>
                     <valueId value="value"></valueId>
                  </parameter>
               </target>
            </rule>
         </rule>
      </rule>
      <rule>
         <name value="no extension"></name>
         <source>
            <context value="dosage"></context>
            <variable value="dosage"></variable>
            <condition value="$this.extension.where(url = 'http://fhir.ch/ig/ch-emed/StructureDefinition/ch-emed-ext-dosagetype').exists() = false"></condition>
         </source>
         <rule>
            <name value="Split Dose"></name>
            <source>
               <context value="dosage"></context>
            </source>
            <target>
               <context value="substanceAdministration"></context>
               <contextType value="variable"></contextType>
               <element value="templateId"></element>
               <variable value="templateId"></variable>
            </target>
            <target>
               <context value="templateId"></context>
               <contextType value="variable"></contextType>
               <element value="root"></element>
               <transform value="copy"></transform>
               <parameter>
                  <valueString value="1.3.6.1.4.1.19376.1.5.3.1.4.9"></valueString>
               </parameter>
            </target>
         </rule>
      </rule>
      <rule>
         <name value="effective time start end"></name>
         <source>
            <context value="dosage"></context>
            <variable value="dosage"></variable>
         </source>
         <target>
            <variable value="substanceAdministration"></variable>
            <transform value="copy"></transform>
            <parameter>
               <valueId value="substanceAdministration"></valueId>
            </parameter>
         </target>
         <dependent>
            <name value="EffectiveTimeStartEnd"></name>
            <variable value="dosage"></variable>
            <variable value="substanceAdministration"></variable>
         </dependent>
      </rule>
      <rule>
         <name value="route"></name>
         <source>
            <context value="dosage"></context>
            <element value="route"></element>
            <variable value="route"></variable>
         </source>
         <target>
            <context value="substanceAdministration"></context>
            <contextType value="variable"></contextType>
            <element value="routeCode"></element>
            <variable value="routeCode"></variable>
         </target>
         <dependent>
            <name value="CodeableConceptCE"></name>
            <variable value="route"></variable>
            <variable value="routeCode"></variable>
         </dependent>
      </rule>
   </group>
   <group>
      <name value="DosageInstructionsEntryDosageChange"></name>
      <typeMode value="none"></typeMode>
      <input>
         <name value="dosage"></name>
         <type value="Dosage"></type>
         <mode value="source"></mode>
      </input>
      <input>
         <name value="substanceAdministration"></name>
         <type value="substanceAdministration"></type>
         <mode value="target"></mode>
      </input>
      <input>
         <name value="entry"></name>
         <type value="entryRelationship"></type>
         <mode value="target"></mode>
      </input>
      <rule>
         <name value="sequence"></name>
         <source>
            <context value="dosage"></context>
            <element value="sequence"></element>
            <variable value="sequence"></variable>
         </source>
         <target>
            <context value="entry"></context>
            <contextType value="variable"></contextType>
            <element value="sequenceNumber"></element>
            <variable value="sequenceNumber"></variable>
         </target>
         <target>
            <context value="sequenceNumber"></context>
            <contextType value="variable"></contextType>
            <element value="value"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueId value="sequence"></valueId>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="dosage"></name>
         <source>
            <context value="dosage"></context>
         </source>
         <target>
            <context value="entry"></context>
            <contextType value="variable"></contextType>
            <element value="substanceAdministration"></element>
            <variable value="substanceAdministration"></variable>
         </target>
         <target>
            <context value="substanceAdministration"></context>
            <contextType value="variable"></contextType>
            <element value="classCode"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="SBADM"></valueString>
            </parameter>
         </target>
         <target>
            <context value="substanceAdministration"></context>
            <contextType value="variable"></contextType>
            <element value="moodCode"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="INT"></valueString>
            </parameter>
         </target>
         <rule>
            <name value="effective time when"></name>
            <source>
               <context value="dosage"></context>
               <variable value="dosage"></variable>
            </source>
            <target>
               <variable value="substanceAdministration"></variable>
               <transform value="copy"></transform>
               <parameter>
                  <valueId value="substanceAdministration"></valueId>
               </parameter>
            </target>
            <dependent>
               <name value="EffectiveTimeWhen"></name>
               <variable value="dosage"></variable>
               <variable value="substanceAdministration"></variable>
            </dependent>
         </rule>
         <rule>
            <name value="dose quantity"></name>
            <source>
               <context value="dosage"></context>
               <variable value="dosage"></variable>
            </source>
            <target>
               <variable value="substanceAdministration"></variable>
               <transform value="copy"></transform>
               <parameter>
                  <valueId value="substanceAdministration"></valueId>
               </parameter>
            </target>
            <dependent>
               <name value="DoseQuantity"></name>
               <variable value="dosage"></variable>
               <variable value="substanceAdministration"></variable>
            </dependent>
         </rule>
         <rule>
            <name value="consumable"></name>
            <source>
               <context value="dosage"></context>
               <variable value="dosage"></variable>
            </source>
            <target>
               <variable value="substanceAdministration"></variable>
               <transform value="copy"></transform>
               <parameter>
                  <valueId value="substanceAdministration"></valueId>
               </parameter>
            </target>
            <target>
               <context value="substanceAdministration"></context>
               <contextType value="variable"></contextType>
               <element value="consumable"></element>
               <variable value="consumable"></variable>
            </target>
            <target>
               <context value="consumable"></context>
               <contextType value="variable"></contextType>
               <element value="manufacturedProduct"></element>
               <variable value="manufacturedProduct"></variable>
            </target>
            <target>
               <context value="manufacturedProduct"></context>
               <contextType value="variable"></contextType>
               <element value="manufacturedMaterial"></element>
               <variable value="manufacturedMaterial"></variable>
            </target>
            <target>
               <context value="manufacturedMaterial"></context>
               <contextType value="variable"></contextType>
               <element value="nullFlavor"></element>
               <transform value="copy"></transform>
               <parameter>
                  <valueString value="NA"></valueString>
               </parameter>
            </target>
         </rule>
      </rule>
   </group>
   <group>
      <name value="EffectiveTimeStartEnd"></name>
      <typeMode value="none"></typeMode>
      <input>
         <name value="dosage"></name>
         <type value="Dosage"></type>
         <mode value="source"></mode>
      </input>
      <input>
         <name value="substanceAdministration"></name>
         <type value="SubstanceAdministration"></type>
         <mode value="target"></mode>
      </input>
      <rule>
         <name value="timing"></name>
         <source>
            <context value="dosage"></context>
            <element value="timing"></element>
            <variable value="timing"></variable>
         </source>
         <rule>
            <name value="repeat"></name>
            <source>
               <context value="timing"></context>
               <element value="repeat"></element>
               <variable value="repeat"></variable>
            </source>
            <rule>
               <name value="bounds"></name>
               <source>
                  <context value="repeat"></context>
                  <type value="Period"></type>
                  <element value="bounds"></element>
                  <variable value="bounds"></variable>
               </source>
               <target>
                  <context value="substanceAdministration"></context>
                  <contextType value="variable"></contextType>
                  <element value="effectiveTime"></element>
                  <variable value="effectiveTime"></variable>
                  <transform value="create"></transform>
                  <parameter>
                     <valueString value="IVL_TS"></valueString>
                  </parameter>
               </target>
               <rule>
                  <name value="low"></name>
                  <source>
                     <context value="bounds"></context>
                     <element value="start"></element>
                     <variable value="start"></variable>
                  </source>
                  <target>
                     <context value="effectiveTime"></context>
                     <contextType value="variable"></contextType>
                     <element value="low"></element>
                     <variable value="low"></variable>
                  </target>
                  <dependent>
                     <name value="DateTS"></name>
                     <variable value="start"></variable>
                     <variable value="low"></variable>
                  </dependent>
               </rule>
               <rule>
                  <name value="high"></name>
                  <source>
                     <context value="bounds"></context>
                     <element value="end"></element>
                     <variable value="end"></variable>
                  </source>
                  <target>
                     <context value="effectiveTime"></context>
                     <contextType value="variable"></contextType>
                     <element value="high"></element>
                     <variable value="high"></variable>
                  </target>
                  <dependent>
                     <name value="DateTS"></name>
                     <variable value="end"></variable>
                     <variable value="high"></variable>
                  </dependent>
               </rule>
            </rule>
         </rule>
      </rule>
   </group>
   <group>
      <name value="EffectiveTimeWhen"></name>
      <typeMode value="none"></typeMode>
      <input>
         <name value="dosage"></name>
         <type value="Dosage"></type>
         <mode value="source"></mode>
      </input>
      <input>
         <name value="substanceAdministration"></name>
         <type value="SubstanceAdministration"></type>
         <mode value="target"></mode>
      </input>
      <rule>
         <name value="timing"></name>
         <source>
            <context value="dosage"></context>
            <element value="timing"></element>
            <variable value="timing"></variable>
         </source>
         <rule>
            <name value="repeat"></name>
            <source>
               <context value="timing"></context>
               <element value="repeat"></element>
               <variable value="repeat"></variable>
            </source>
            <rule>
               <name value="when"></name>
               <source>
                  <context value="repeat"></context>
                  <condition value="$this.when.count() = 1"></condition>
               </source>
               <target>
                  <context value="substanceAdministration"></context>
                  <contextType value="variable"></contextType>
                  <element value="effectiveTime"></element>
                  <variable value="effectiveTime"></variable>
                  <transform value="create"></transform>
                  <parameter>
                     <valueString value="EIVL_TS"></valueString>
                  </parameter>
               </target>
               <rule>
                  <name value="when"></name>
                  <source>
                     <context value="repeat"></context>
                     <element value="when"></element>
                     <variable value="when"></variable>
                  </source>
                  <target>
                     <context value="effectiveTime"></context>
                     <contextType value="variable"></contextType>
                     <element value="event"></element>
                     <variable value="event"></variable>
                  </target>
                  <target>
                     <context value="event"></context>
                     <contextType value="variable"></contextType>
                     <element value="code"></element>
                     <transform value="copy"></transform>
                     <parameter>
                        <valueId value="when"></valueId>
                     </parameter>
                  </target>
               </rule>
            </rule>
            <rule>
               <name value="when"></name>
               <source>
                  <context value="repeat"></context>
                  <condition value="$this.when.count() &gt; 1"></condition>
               </source>
               <target>
                  <context value="substanceAdministration"></context>
                  <contextType value="variable"></contextType>
                  <element value="effectiveTime"></element>
                  <variable value="effectiveTime"></variable>
                  <transform value="create"></transform>
                  <parameter>
                     <valueString value="SXPR_TS"></valueString>
                  </parameter>
               </target>
               <target>
                  <context value="effectiveTime"></context>
                  <contextType value="variable"></contextType>
                  <element value="operator"></element>
                  <transform value="copy"></transform>
                  <parameter>
                     <valueString value="A"></valueString>
                  </parameter>
               </target>
               <rule>
                  <name value="comp"></name>
                  <source>
                     <context value="repeat"></context>
                     <element value="when"></element>
                     <listMode value="first"></listMode>
                     <variable value="when"></variable>
                  </source>
                  <target>
                     <context value="effectiveTime"></context>
                     <contextType value="variable"></contextType>
                     <element value="comp"></element>
                     <variable value="comp"></variable>
                     <transform value="create"></transform>
                     <parameter>
                        <valueString value="EIVL_TS"></valueString>
                     </parameter>
                  </target>
                  <rule>
                     <name value="when"></name>
                     <source>
                        <context value="when"></context>
                     </source>
                     <target>
                        <context value="comp"></context>
                        <contextType value="variable"></contextType>
                        <element value="event"></element>
                        <variable value="event"></variable>
                     </target>
                     <target>
                        <context value="event"></context>
                        <contextType value="variable"></contextType>
                        <element value="code"></element>
                        <transform value="copy"></transform>
                        <parameter>
                           <valueId value="when"></valueId>
                        </parameter>
                     </target>
                  </rule>
               </rule>
               <rule>
                  <name value="compnotfirst"></name>
                  <source>
                     <context value="repeat"></context>
                     <element value="when"></element>
                     <listMode value="not_first"></listMode>
                     <variable value="when"></variable>
                  </source>
                  <target>
                     <context value="effectiveTime"></context>
                     <contextType value="variable"></contextType>
                     <element value="comp"></element>
                     <variable value="comp"></variable>
                     <transform value="create"></transform>
                     <parameter>
                        <valueString value="EIVL_TS"></valueString>
                     </parameter>
                  </target>
                  <target>
                     <context value="comp"></context>
                     <contextType value="variable"></contextType>
                     <element value="operator"></element>
                     <transform value="copy"></transform>
                     <parameter>
                        <valueString value="I"></valueString>
                     </parameter>
                  </target>
                  <rule>
                     <name value="when"></name>
                     <source>
                        <context value="when"></context>
                     </source>
                     <target>
                        <context value="comp"></context>
                        <contextType value="variable"></contextType>
                        <element value="event"></element>
                        <variable value="event"></variable>
                     </target>
                     <target>
                        <context value="event"></context>
                        <contextType value="variable"></contextType>
                        <element value="code"></element>
                        <transform value="copy"></transform>
                        <parameter>
                           <valueId value="when"></valueId>
                        </parameter>
                     </target>
                  </rule>
               </rule>
            </rule>
         </rule>
      </rule>
   </group>
   <group>
      <name value="DoseQuantity"></name>
      <typeMode value="none"></typeMode>
      <input>
         <name value="dosage"></name>
         <type value="Dosage"></type>
         <mode value="source"></mode>
      </input>
      <input>
         <name value="substanceAdministration"></name>
         <type value="SubstanceAdministration"></type>
         <mode value="target"></mode>
      </input>
      <rule>
         <name value="doseQuantity"></name>
         <source>
            <context value="dosage"></context>
            <element value="doseAndRate"></element>
            <variable value="doseAndRate"></variable>
         </source>
         <target>
            <context value="substanceAdministration"></context>
            <contextType value="variable"></contextType>
            <element value="doseQuantity"></element>
            <variable value="doseQuantity"></variable>
         </target>
         <rule>
            <name value="quantity"></name>
            <source>
               <context value="doseAndRate"></context>
               <type value="Quantity"></type>
               <element value="dose"></element>
               <variable value="quantity"></variable>
            </source>
            <rule>
               <name value="value"></name>
               <source>
                  <context value="quantity"></context>
                  <element value="value"></element>
                  <variable value="value"></variable>
               </source>
               <target>
                  <context value="doseQuantity"></context>
                  <contextType value="variable"></contextType>
                  <element value="center"></element>
                  <variable value="center"></variable>
               </target>
               <target>
                  <context value="center"></context>
                  <contextType value="variable"></contextType>
                  <element value="value"></element>
                  <transform value="copy"></transform>
                  <parameter>
                     <valueId value="value"></valueId>
                  </parameter>
               </target>
            </rule>
         </rule>
      </rule>
   </group>
   <group>
      <name value="TreatmentReasonEntryContentModule"></name>
      <typeMode value="none"></typeMode>
      <input>
         <name value="reasonCode"></name>
         <type value="Coding"></type>
         <mode value="source"></mode>
      </input>
      <input>
         <name value="observation"></name>
         <type value="Observation"></type>
         <mode value="target"></mode>
      </input>
      <rule>
         <name value="OBS"></name>
         <source>
            <context value="reasonCode"></context>
         </source>
         <target>
            <context value="observation"></context>
            <contextType value="variable"></contextType>
            <element value="classCode"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="OBS"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="EVN"></name>
         <source>
            <context value="reasonCode"></context>
         </source>
         <target>
            <context value="observation"></context>
            <contextType value="variable"></contextType>
            <element value="moodCode"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="EVN"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="TreatmentReasonEntryContentModule"></name>
         <source>
            <context value="reasonCode"></context>
         </source>
         <target>
            <context value="observation"></context>
            <contextType value="variable"></contextType>
            <element value="templateId"></element>
            <variable value="templateId"></variable>
         </target>
         <target>
            <context value="templateId"></context>
            <contextType value="variable"></contextType>
            <element value="root"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="2.16.756.5.30.1.1.10.4.41"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="code"></name>
         <source>
            <context value="reasonCode"></context>
         </source>
         <target>
            <context value="observation"></context>
            <contextType value="variable"></contextType>
            <element value="code"></element>
            <variable value="code"></variable>
         </target>
         <target>
            <context value="code"></context>
            <contextType value="variable"></contextType>
            <element value="code"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="75326-9"></valueString>
            </parameter>
         </target>
         <target>
            <context value="code"></context>
            <contextType value="variable"></contextType>
            <element value="codeSystem"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="2.16.840.1.113883.6.1"></valueString>
            </parameter>
         </target>
         <target>
            <context value="code"></context>
            <contextType value="variable"></contextType>
            <element value="displayName"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="Problem"></valueString>
            </parameter>
         </target>
         <target>
            <context value="code"></context>
            <contextType value="variable"></contextType>
            <element value="codeSystemName"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="LOINC"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="id"></name>
         <source>
            <context value="reasonCode"></context>
            <element value="extension"></element>
            <variable value="extension"></variable>
            <condition value="$this.url = 'http://hl7.org/fhir/StructureDefinition/narrativeLink'"></condition>
         </source>
         <rule>
            <name value="reference"></name>
            <source>
               <context value="extension"></context>
               <element value="valueUrl"></element>
               <variable value="valueUrl"></variable>
            </source>
            <target>
               <context value="observation"></context>
               <contextType value="variable"></contextType>
               <element value="text"></element>
               <variable value="text"></variable>
            </target>
            <target>
               <context value="text"></context>
               <contextType value="variable"></contextType>
               <element value="reference"></element>
               <variable value="reference"></variable>
            </target>
            <target>
               <context value="reference"></context>
               <contextType value="variable"></contextType>
               <element value="value"></element>
               <transform value="copy"></transform>
               <parameter>
                  <valueId value="valueUrl"></valueId>
               </parameter>
            </target>
         </rule>
      </rule>
      <rule>
         <name value="statuscode"></name>
         <source>
            <context value="reasonCode"></context>
         </source>
         <target>
            <context value="observation"></context>
            <contextType value="variable"></contextType>
            <element value="statusCode"></element>
            <variable value="code"></variable>
         </target>
         <target>
            <context value="code"></context>
            <contextType value="variable"></contextType>
            <element value="code"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="completed"></valueString>
            </parameter>
         </target>
      </rule>
   </group>
   <group>
      <name value="MTPReferenceEntryContentModule"></name>
      <typeMode value="none"></typeMode>
      <input>
         <name value="ext"></name>
         <type value="Extension"></type>
         <mode value="source"></mode>
      </input>
      <input>
         <name value="substanceAdministration"></name>
         <type value="SubstanceAdministration"></type>
         <mode value="target"></mode>
      </input>
      <rule>
         <name value="SBADM"></name>
         <source>
            <context value="ext"></context>
         </source>
         <target>
            <context value="substanceAdministration"></context>
            <contextType value="variable"></contextType>
            <element value="classCode"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="SBADM"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="INT"></name>
         <source>
            <context value="ext"></context>
         </source>
         <target>
            <context value="substanceAdministration"></context>
            <contextType value="variable"></contextType>
            <element value="moodCode"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="INT"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="Reference to Medication Treatment Plan Item General Specification Template ID"></name>
         <source>
            <context value="ext"></context>
         </source>
         <target>
            <context value="substanceAdministration"></context>
            <contextType value="variable"></contextType>
            <element value="templateId"></element>
            <variable value="templateId"></variable>
         </target>
         <target>
            <context value="templateId"></context>
            <contextType value="variable"></contextType>
            <element value="root"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="1.3.6.1.4.1.19376.1.9.1.3.10"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="CH-PHARM template ID	"></name>
         <source>
            <context value="ext"></context>
         </source>
         <target>
            <context value="substanceAdministration"></context>
            <contextType value="variable"></contextType>
            <element value="templateId"></element>
            <variable value="templateId"></variable>
         </target>
         <target>
            <context value="templateId"></context>
            <contextType value="variable"></contextType>
            <element value="root"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="2.16.756.5.30.1.1.10.4.45"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="id"></name>
         <source>
            <context value="ext"></context>
            <element value="extension"></element>
            <variable value="extension"></variable>
            <condition value="$this.url = 'id'"></condition>
         </source>
         <rule>
            <name value="id"></name>
            <source>
               <context value="extension"></context>
               <element value="valueIdentifier"></element>
               <variable value="valueIdentifier"></variable>
            </source>
            <target>
               <context value="substanceAdministration"></context>
               <contextType value="variable"></contextType>
               <element value="id"></element>
               <variable value="id"></variable>
            </target>
            <dependent>
               <name value="IdentifierII"></name>
               <variable value="valueIdentifier"></variable>
               <variable value="id"></variable>
            </dependent>
         </rule>
      </rule>
      <rule>
         <name value="code"></name>
         <source>
            <context value="ext"></context>
         </source>
         <target>
            <context value="substanceAdministration"></context>
            <contextType value="variable"></contextType>
            <element value="code"></element>
            <variable value="code"></variable>
         </target>
         <target>
            <context value="code"></context>
            <contextType value="variable"></contextType>
            <element value="code"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="MTPItem"></valueString>
            </parameter>
         </target>
         <target>
            <context value="code"></context>
            <contextType value="variable"></contextType>
            <element value="codeSystem"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="1.3.6.1.4.1.19376.1.9.2.2"></valueString>
            </parameter>
         </target>
         <target>
            <context value="code"></context>
            <contextType value="variable"></contextType>
            <element value="displayName"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="Medication Treatment Plan Item"></valueString>
            </parameter>
         </target>
         <target>
            <context value="code"></context>
            <contextType value="variable"></contextType>
            <element value="codeSystemName"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="IHE Pharmacy Item Type List"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="consumable"></name>
         <source>
            <context value="ext"></context>
         </source>
         <target>
            <context value="substanceAdministration"></context>
            <contextType value="variable"></contextType>
            <element value="consumable"></element>
            <variable value="consumable"></variable>
         </target>
         <target>
            <context value="consumable"></context>
            <contextType value="variable"></contextType>
            <element value="manufacturedProduct"></element>
            <variable value="manufacturedProduct"></variable>
         </target>
         <target>
            <context value="manufacturedProduct"></context>
            <contextType value="variable"></contextType>
            <element value="manufacturedMaterial"></element>
            <variable value="manufacturedMaterial"></variable>
         </target>
         <target>
            <context value="manufacturedMaterial"></context>
            <contextType value="variable"></contextType>
            <element value="nullFlavor"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="NA"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="externalDocumentId"></name>
         <source>
            <context value="ext"></context>
            <element value="extension"></element>
            <variable value="extension"></variable>
            <condition value="$this.url = 'externalDocumentId'"></condition>
         </source>
         <rule>
            <name value="id"></name>
            <source>
               <context value="extension"></context>
               <element value="valueIdentifier"></element>
               <variable value="valueIdentifier"></variable>
            </source>
            <target>
               <context value="substanceAdministration"></context>
               <contextType value="variable"></contextType>
               <element value="reference"></element>
               <variable value="reference"></variable>
            </target>
            <target>
               <context value="reference"></context>
               <contextType value="variable"></contextType>
               <element value="typeCode"></element>
               <transform value="copy"></transform>
               <parameter>
                  <valueString value="XCRPT"></valueString>
               </parameter>
            </target>
            <target>
               <context value="reference"></context>
               <contextType value="variable"></contextType>
               <element value="externalDocument"></element>
               <variable value="externalDocument"></variable>
            </target>
            <target>
               <context value="externalDocument"></context>
               <contextType value="variable"></contextType>
               <element value="id"></element>
               <variable value="id"></variable>
            </target>
            <dependent>
               <name value="IdentifierII"></name>
               <variable value="valueIdentifier"></variable>
               <variable value="id"></variable>
            </dependent>
         </rule>
      </rule>
   </group>
   <group>
      <name value="DosageInstructionsNonStructuredEntryContentModule"></name>
      <typeMode value="none"></typeMode>
      <input>
         <name value="dosage"></name>
         <type value="Dosage"></type>
         <mode value="source"></mode>
      </input>
      <input>
         <name value="substanceAdministration"></name>
         <type value="SubstanceAdministration"></type>
         <mode value="target"></mode>
      </input>
      <rule>
         <name value="SBADM"></name>
         <source>
            <context value="dosage"></context>
         </source>
         <target>
            <context value="substanceAdministration"></context>
            <contextType value="variable"></contextType>
            <element value="classCode"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="SBADM"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="INT"></name>
         <source>
            <context value="dosage"></context>
         </source>
         <target>
            <context value="substanceAdministration"></context>
            <contextType value="variable"></contextType>
            <element value="moodCode"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="INT"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="template ID	"></name>
         <source>
            <context value="dosage"></context>
         </source>
         <target>
            <context value="substanceAdministration"></context>
            <contextType value="variable"></contextType>
            <element value="templateId"></element>
            <variable value="templateId"></variable>
         </target>
         <target>
            <context value="templateId"></context>
            <contextType value="variable"></contextType>
            <element value="root"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="2.16.756.5.30.1.1.10.4.37"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="id"></name>
         <source>
            <context value="dosage"></context>
            <element value="extension"></element>
            <variable value="extension"></variable>
            <condition value="$this.url = 'http://hl7.org/fhir/StructureDefinition/narrativeLink'"></condition>
         </source>
         <rule>
            <name value="reference"></name>
            <source>
               <context value="extension"></context>
               <element value="valueUrl"></element>
               <variable value="valueUrl"></variable>
            </source>
            <target>
               <context value="substanceAdministration"></context>
               <contextType value="variable"></contextType>
               <element value="text"></element>
               <variable value="text"></variable>
            </target>
            <target>
               <context value="text"></context>
               <contextType value="variable"></contextType>
               <element value="reference"></element>
               <variable value="reference"></variable>
            </target>
            <target>
               <context value="reference"></context>
               <contextType value="variable"></contextType>
               <element value="value"></element>
               <transform value="copy"></transform>
               <parameter>
                  <valueId value="valueUrl"></valueId>
               </parameter>
            </target>
         </rule>
      </rule>
      <rule>
         <name value="consumable"></name>
         <source>
            <context value="dosage"></context>
         </source>
         <target>
            <context value="substanceAdministration"></context>
            <contextType value="variable"></contextType>
            <element value="consumable"></element>
            <variable value="consumable"></variable>
         </target>
         <target>
            <context value="consumable"></context>
            <contextType value="variable"></contextType>
            <element value="manufacturedProduct"></element>
            <variable value="manufacturedProduct"></variable>
         </target>
         <target>
            <context value="manufacturedProduct"></context>
            <contextType value="variable"></contextType>
            <element value="manufacturedMaterial"></element>
            <variable value="manufacturedMaterial"></variable>
         </target>
         <target>
            <context value="manufacturedMaterial"></context>
            <contextType value="variable"></contextType>
            <element value="nullFlavor"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="NA"></valueString>
            </parameter>
         </target>
      </rule>
   </group>
   <group>
      <name value="BundleToClinicalDocumentEmedMedicationPrescriptionDocument"></name>
      <extends value="BundleToClinicalDocumentCh"></extends>
      <typeMode value="none"></typeMode>
      <input>
         <name value="bundle"></name>
         <type value="Bundle"></type>
         <mode value="source"></mode>
      </input>
      <input>
         <name value="recordTarget"></name>
         <type value="RecordTarget"></type>
         <mode value="target"></mode>
      </input>
      <input>
         <name value="author"></name>
         <type value="Author"></type>
         <mode value="target"></mode>
      </input>
      <input>
         <name value="cda"></name>
         <type value="ClinicalDocument"></type>
         <mode value="target"></mode>
      </input>
      <rule>
         <name value="Exchange format according to the Swiss EPR"></name>
         <source>
            <context value="bundle"></context>
         </source>
         <target>
            <context value="cda"></context>
            <contextType value="variable"></contextType>
            <element value="templateId"></element>
            <variable value="templateId"></variable>
         </target>
         <target>
            <context value="templateId"></context>
            <contextType value="variable"></contextType>
            <element value="root"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="2.16.756.5.30.1.127.1.4"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="IHE PCC"></name>
         <source>
            <context value="bundle"></context>
         </source>
         <target>
            <context value="cda"></context>
            <contextType value="variable"></contextType>
            <element value="templateId"></element>
            <variable value="templateId"></variable>
         </target>
         <target>
            <context value="templateId"></context>
            <contextType value="variable"></contextType>
            <element value="root"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="1.3.6.1.4.1.19376.1.5.3.1.1.1"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="IHE PRE"></name>
         <source>
            <context value="bundle"></context>
         </source>
         <target>
            <context value="cda"></context>
            <contextType value="variable"></contextType>
            <element value="templateId"></element>
            <variable value="templateId"></variable>
         </target>
         <target>
            <context value="templateId"></context>
            <contextType value="variable"></contextType>
            <element value="root"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="1.3.6.1.4.1.19376.1.9.1.1.1"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="CDA-CH-EMED Medication Prescription document"></name>
         <source>
            <context value="bundle"></context>
         </source>
         <target>
            <context value="cda"></context>
            <contextType value="variable"></contextType>
            <element value="templateId"></element>
            <variable value="templateId"></variable>
         </target>
         <target>
            <context value="templateId"></context>
            <contextType value="variable"></contextType>
            <element value="root"></element>
            <transform value="copy"></transform>
            <parameter>
               <valueString value="2.16.756.5.30.1.1.10.1.4"></valueString>
            </parameter>
         </target>
      </rule>
      <rule>
         <name value="entry"></name>
         <source>
            <context value="bundle"></context>
            <element value="entry"></element>
            <variable value="entry"></variable>
         </source>
         <rule>
            <name value="resource"></name>
            <source>
               <context value="entry"></context>
               <element value="resource"></element>
               <variable value="resource"></variable>
               <condition value="$this.ofType(FHIR.Composition)"></condition>
            </source>
            <dependent>
               <name value="CompositionClinicalDocumentChEmedMedicationPrescriptionDocument"></name>
               <variable value="bundle"></variable>
               <variable value="resource"></variable>
               <variable value="cda"></variable>
            </dependent>
         </rule>
      </rule>
   </group>
</StructureMap>